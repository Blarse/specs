%define target_lua_version 5.4

# Original package name argparse
%define oname argparse
%define oversion 0.7.1-1
%define rockspec argparse-0.7.1-1.rockspec
Name: lua%target_lua_version-module-%oname
Version: 0.7.1
Release: alt1_lr1
Summary: A feature-rich command-line argument parser
License: MIT
Group: Development/Other
Url: https://github.com/luarocks/argparse

Source: https://github.com/luarocks/argparse/archive/0.7.1.zip
Source1: https://luarocks.org/manifests/luarocks/argparse-0.7.1-1.rockspec

BuildPreReq: rpm-macros-lua >= 1.5.2 rpm-build-lua
# Automatically added by buildreq on ...
BuildRequires: lua%target_lua_version-luarocks

BuildArch: noarch
BuildRequires: lua5.3-luarocks lua5.1-luarocks

%description
Argparse supports positional arguments, options, flags, optional arguments, subcommands and more. Argparse automatically generates usage, help, and error messages, and can generate shell completion scripts.

%package -n lua5.3-module-%oname
Summary: A feature-rich command-line argument parser
Group: Development/Other
%description -n lua5.3-module-%oname
Argparse supports positional arguments, options, flags, optional arguments, subcommands and more. Argparse automatically generates usage, help, and error messages, and can generate shell completion scripts.
%package -n lua5.1-module-%oname
Summary: A feature-rich command-line argument parser
Group: Development/Other
%description -n lua5.1-module-%oname
Argparse supports positional arguments, options, flags, optional arguments, subcommands and more. Argparse automatically generates usage, help, and error messages, and can generate shell completion scripts.

%prep
%setup -n %oname-%version

%install
%luarocks_make %SOURCE1
%luarocks_move_docs doc

%check
[ -x /usr/bin/busted ] || exit 0
%lua_path_add_buildroot
busted

%add_findreq_skiplist %luarocks_dbdir_prefix-*/%oname/*/{doc,docs,etc,examples,samples,spec,test}/*

%files
%lua54_modulesdir_noarch/*
%luarocks_dbdir_prefix-%target_lua_version/%oname
%doc docsrc/* docs_from_rockstree/*
%exclude %luarocks_dbdir_prefix-%target_lua_version/manifest

%files -n lua5.3-module-%oname
%lua53_modulesdir_noarch/*
%luarocks_dbdir_prefix-5.3/%oname
%doc docsrc/* docs_from_rockstree/*
%exclude %luarocks_dbdir_prefix-5.3/manifest

%files -n lua5.1-module-%oname
%lua51_modulesdir_noarch/*
%luarocks_dbdir_prefix-5.1/%oname
%doc docsrc/* docs_from_rockstree/*
%exclude %luarocks_dbdir_prefix-5.1/manifest

%changelog
* Sun Jan 07 2024 Ildar Mulyukov <ildar@altlinux.ru> 0.7.1-alt1_lr1
- autogenerated by lrimport
